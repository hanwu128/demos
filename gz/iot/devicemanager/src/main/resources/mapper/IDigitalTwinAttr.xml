<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.lenovo.iot.devicemanager.dao.DigitalTwinAttrDao">
	<insert id="addDigitalTwinAttr"
            useGeneratedKeys="true"
            keyProperty="id">
        INSERT INTO digitaltwin(daddyid,sonname,digitaltwinname,describemessage,unit,metric,tagkv,createtimestamp,updatetimestamp) VALUES
        <foreach collection="list" item="dtAttr" separator=",">
            (#{dtAttr.daddyid},#{dtAttr.sonname},#{dtAttr.digitaltwinname},#{dtAttr.describemessage},#{dtAttr.unit},#{dtAttr.metric},#{dtAttr.tagkv},now(),now())
        </foreach>
	</insert>
    
    <update id="updateDigitalTwinAttr" parameterType="com.lenovo.iot.devicemanager.model.DigitalTwinAttrParam">
        UPDATE digitaltwin SET digitaltwinname=#{digitaltwinname},sonname=#{sonname},describemessage=#{describemessage},unit=#{unit},metric=#{metric},tagkv=#{tagkv} WHERE id=#{id}
    </update>

    <update id="updateDigitalTwinAttrValue" parameterType="com.lenovo.iot.devicemanager.model.DigitalTwinAttrValueMeta">
        UPDATE digitaltwin SET value=#{value},valuetimestamp=#{valuetimestamp} where id=#{id}
    </update>

    <select id="getDigitalTwinAttrList" resultType="com.lenovo.iot.devicemanager.model.DigitalTwinAttrParam" parameterType="java.lang.Long">
        SELECT * FROM digitaltwin WHERE daddyid=#{daddyid};
    </select>

</mapper>